

yield<-function(Nini=150,mult=1,
              epl=c(0.073, 0.07, 0.197,0.304),
               W=c(0.00822,0.01155,0.01528,0.02651),
               M=rep(0.29,4)) {
  
  FI=epl*mult
  Z=M+FI
  N<-rep(0,4)
  N[1]=Nini
  for (q in (2:4)) N[q]=N[q-1]*exp(-Z[q-1])
  Nbar=N*(1-exp(-Z))/Z
  yield=Nbar*FI*W
  return(sum(yield))
}  

yield(mult=1)

fmults<-seq(0,5,0.05)
Yield<-fmults
for (m in (1:length(fmults))) Yield[m]=yield(mult=fmults[m])
head(Yield,20)
plot(fmults,Yield)


fmults<-seq(0,3,0.01)
Yield<-fmults
for (rep in (1:5)) {
  Yield<-fmults # just structure
  epl=abs(rnorm(4))
  epl=epl/mean(epl)
  for (m in (1:length(fmults))) Yield[m]=yield(mult=fmults[m], epl=epl)
 
  if (rep==1) plot(fmults,Yield,type='l') else lines(fmults,Yield,col=rep)
}
